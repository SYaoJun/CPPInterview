# MySQL
- 关系型数据库
### 参考书籍
- 《MySQL技术内幕：InnoDB存储引擎》
### 存储引擎
- 存储引擎是基于表的，而不是数据库。
- InnoDB存储引擎的默认支持的隔离级别是 REPEATABLE-READ（可重读）
1. InnoDB
    - 支持事务
    - 面向在线事务处理(OLTP)
    - 多版本并发机制MVCC获得高性能
    - 聚集
2. MyISAM
    - 不支持事务、表锁设计，支持全文索引
    - MYD存储数据、MYI存放索引
3. NDB
    - 集群存储引擎
    - 连接操作成本高，查询速度慢
4. Memory
    - 表中数据放到内存里面
    - 做临时表存放查询的中间结果集
5. Archive
    - 只支持Insert和Select操作
    - 压缩存储，适合存储归档数据
    - 高速的插入和压缩功能
6. Federated
    - 不存放数据
    - 指向远程数据库服务器上的表
7. Maria
    - 目标是为了替代MyISAM
    - 支持缓存和索引文件、行锁、MVCC、事务
## myISAM和InnoDB的区别
- InnoDB引擎：
  1. 支持事务
  2. 行锁（适合高并发）
  3. 支持外键
  4. MySQL 5.5版本后的默认存储引擎
- MyISAM引擎：
  1. 不支持事务
  2. 不支持外键
  3. 支持表锁。优势是访问的速度快。
  4. MySQL 5.5版本前的默认存储引擎。
  5. myISAM索引文件和数据文件是分离的，查询较多的更新较少的情况下优先使用。
  
### Clustered Index 聚集索引
- 聚集索引，又称为主键索引。
- InnoDB是索引组织表，表中数据按照主键顺序存放。
- 聚集索引是按照每张表的主键，构造一颗B+树，同时叶子节点中存放的即为整张表的行记录数据，也将聚集索引的叶子节点称为数据页data page。
- 每张表只能拥有一个聚集索引。
### Secondary Index 辅助索引
- 辅助索引，又称为非聚集索引，或者二级索引。
- 辅助索引是指叶子节点并不包含行记录的全部数据。
- 聚集索引和辅助索引的区别在于叶子几点存放的是否是一整行的信息。
- 所有辅助索引的叶子节点都引用主键索引，过长的主索引会使得辅助索引变得过大。
- 唯一索引，普通索引，前缀索引都是二级索引
> 思考：为什么辅助索引叶子节点不直接存行记录的指针，而要存主键索引的值？
### Undo log
1. 用于恢复已提交事务修改的页操作。
2. 物理日志。
3. 用来保证事务的原子性和持久性。
4. 在disk。
### Redo log
1. 回滚行记录到某个特定版本。
2. 逻辑日志。
3. 用来保证事务的一致性。
4. 在memory。
### Binlog
1. 操作日志
### MVCC
- 多版本并发控制